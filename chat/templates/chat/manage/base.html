<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
  <meta charset="UTF-8">
  <title>{% block title %}Euphorie Admin{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f9fafb;
    }

    /* Fixed: Using only the webkit version that works in Chrome */
    .hide-scrollbar::-webkit-scrollbar {
      display: none; /* Chrome, Safari, Opera */
    }

    .gradient-text {
      background: linear-gradient(135deg, #ec4899, #f97316);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .admin-sidebar {
      width: 280px;
      transition: all 0.3s ease;
      z-index: 30;
    }

    @media (max-width: 1023px) {
      .admin-sidebar {
        transform: translateX(-100%);
        width: 250px;
      }

      .admin-sidebar.open {
        transform: translateX(0);
      }

      .overlay {
        display: none;
      }

      .overlay.active {
        display: block;
      }
    }

    .nav-link {
      transition: all 0.2s ease;
      border-radius: 8px;
    }

    .nav-link:hover {
      background-color: rgba(236, 72, 153, 0.1);
    }

    .nav-link.active {
      background-color: rgba(236, 72, 153, 0.2);
      color: #ec4899;
    }

    /* Mobile-specific styles */
    @media (max-width: 640px) {
      .mobile-menu-button {
        top: 0.75rem;
        left: 0.75rem;
      }

      .mobile-padding {
        padding: 0.75rem;
      }

      .mobile-text-sm {
        font-size: 0.875rem;
      }

      .mobile-text-xs {
        font-size: 0.75rem;
      }
    }
  </style>
  {% block extra_css %}{% endblock %}
</head>
<body>
  <!-- Mobile menu button -->
  <div class="lg:hidden fixed top-4 left-4 z-40 mobile-menu-button">
    <button id="mobile-menu-button" class="p-2 rounded-md bg-white shadow-md border border-pink-100" aria-label="Toggle mobile menu">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 sm:h-6 sm:w-6 text-pink-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>
  </div>

  <!-- Overlay for mobile -->
  <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-20 overlay"></div>

  <!-- Admin sidebar -->
  <aside id="admin-sidebar" class="admin-sidebar fixed top-0 left-0 h-full bg-white shadow-md border-r border-pink-100 overflow-y-auto">
    <div class="p-4 sm:p-6">
      <div class="flex justify-between items-center mb-6">
        <a href="{% url 'admin_dashboard' %}" class="flex items-center">
          <h1 class="text-lg sm:text-xl font-bold gradient-text">Euphorie Admin</h1>
        </a>

        <!-- Close button (visible only on mobile) -->
        <button id="close-sidebar" class="lg:hidden text-gray-500 hover:text-gray-700">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>

      <nav class="space-y-1">
        <a href="{% url 'admin_dashboard' %}" class="nav-link flex items-center px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base text-gray-700 {% if request.resolver_match.url_name == 'admin_dashboard' %}active{% endif %}">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5 mr-2 sm:mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
          </svg>
          Dashboard
        </a>

        <a href="{% url 'admin_rooms' %}" class="nav-link flex items-center px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base text-gray-700 {% if request.resolver_match.url_name == 'admin_rooms' or request.resolver_match.url_name == 'admin_room_detail' %}active{% endif %}">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5 mr-2 sm:mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
          </svg>
          Rooms
        </a>

        <a href="{% url 'admin_messages' %}" class="nav-link flex items-center px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base text-gray-700 {% if request.resolver_match.url_name == 'admin_messages' or request.resolver_match.url_name == 'admin_filter_messages' %}active{% endif %}">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5 mr-2 sm:mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
          </svg>
          Messages
        </a>

        <a href="{% url 'admin_user_activity' %}" class="nav-link flex items-center px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base text-gray-700 {% if request.resolver_match.url_name == 'admin_user_activity' or request.resolver_match.url_name == 'admin_user_messages' %}active{% endif %}">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5 mr-2 sm:mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
          </svg>
          User Activity
        </a>

        <hr class="my-3 sm:my-4 border-gray-200">

        <a href="{% url 'index' %}" class="nav-link flex items-center px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base text-gray-700">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5 mr-2 sm:mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
          </svg>
          Back to Site
        </a>

        <form method="post" action="{% url 'logout' %}">
          {% csrf_token %}
          <button type="submit" class="nav-link w-full flex items-center px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base text-gray-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5 mr-2 sm:mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
            </svg>
            Logout
          </button>
        </form>
      </nav>
    </div>
  </aside>

  <!-- Main content -->
  <main class="lg:ml-[280px] min-h-screen flex flex-col">
    <!-- Add padding for mobile menu button -->
    <div class="lg:hidden h-14 sm:h-16"></div>

    <!-- Notification messages -->
    {% if messages %}
    <div class="px-3 sm:px-4 py-2">
      {% for message in messages %}
      <div class="mb-3 sm:mb-4 px-3 sm:px-4 py-2 sm:py-3 rounded-lg text-sm sm:text-base {% if message.tags == 'success' %}bg-green-100 text-green-800{% elif message.tags == 'error' %}bg-red-100 text-red-800{% else %}bg-blue-100 text-blue-800{% endif %}">
        {{ message }}
      </div>
      {% endfor %}
    </div>
    {% endif %}

    {% block content %}{% endblock %}
  </main>

  <script>
    // Mobile menu toggle
    document.addEventListener('DOMContentLoaded', function() {
      const mobileMenuButton = document.getElementById('mobile-menu-button');
      const adminSidebar = document.getElementById('admin-sidebar');
      const closeSidebar = document.getElementById('close-sidebar');
      const overlay = document.getElementById('sidebar-overlay');

      if (mobileMenuButton && adminSidebar) {
        // Open sidebar
        mobileMenuButton.addEventListener('click', function() {
          adminSidebar.classList.add('open');
          overlay.classList.add('active');
          // Prevent scrolling on the body when sidebar is open
          document.body.style.overflow = 'hidden';
        });

        // Close sidebar with X button
        if (closeSidebar) {
          closeSidebar.addEventListener('click', function() {
            adminSidebar.classList.remove('open');
            overlay.classList.remove('active');
            document.body.style.overflow = '';
          });
        }

        // Close sidebar when clicking on overlay
        if (overlay) {
          overlay.addEventListener('click', function() {
            adminSidebar.classList.remove('open');
            overlay.classList.remove('active');
            document.body.style.overflow = '';
          });
        }

        // Close sidebar when clicking on a link
        const navLinks = document.querySelectorAll('.nav-link');
        navLinks.forEach(function(link) {
          link.addEventListener('click', function() {
            if (window.innerWidth < 1024) {
              adminSidebar.classList.remove('open');
              overlay.classList.remove('active');
              document.body.style.overflow = '';
            }
          });
        });
      }
    });
  </script>

  {% block extra_js %}{% endblock %}
</body>
</html>
